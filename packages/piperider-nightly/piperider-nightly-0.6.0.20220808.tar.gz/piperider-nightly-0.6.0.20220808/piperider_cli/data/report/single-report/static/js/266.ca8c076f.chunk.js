"use strict";(self.webpackChunkpiperider_report=self.webpackChunkpiperider_report||[]).push([[266],{6787:function(n,e,t){t.r(e),t.d(e,{default:function(){return H}});var i=t(1413),l=t(885),r=t(5223),s=t(8735),a=t(6837),o=t(4385),d=t(8625),u=t(2791),c=t(7260),v=t(6157),h=t(2483),x=t(3442),j=t(5987),f=t(1564),p=t(2504),m=t(7005),g=t(2387),b=t(184);function T(n){switch(n.status){case"passed":return(0,b.jsx)(s.xv,{as:"span",role:"img",children:"\u2705"});case"failed":return(0,b.jsx)(s.xv,{as:"span",role:"img",children:"\u274c"});default:return(0,b.jsx)(s.xv,{as:"span",role:"img",children:"-"})}}function y(n){var e,t,i,l,r,s,a=n.data;return(0,b.jsx)(m.xJ,{children:(0,b.jsxs)(m.iA,{variant:"simple",children:[(0,b.jsx)(m.hr,{children:(0,b.jsxs)(m.Tr,{children:[(0,b.jsx)(m.Th,{}),(0,b.jsx)(m.Th,{children:"Status"}),(0,b.jsx)(m.Th,{children:"Message"})]})}),(0,b.jsxs)(m.p3,{children:[(0,b.jsxs)(m.Tr,{children:[(0,b.jsx)(m.Td,{fontWeight:700,children:"Base"}),(0,b.jsx)(m.Td,{children:(0,b.jsx)(T,{status:null===a||void 0===a||null===(e=a.base)||void 0===e?void 0:e.status})}),(0,b.jsx)(m.Td,{children:null!==(t=null===a||void 0===a||null===(i=a.base)||void 0===i?void 0:i.message)&&void 0!==t?t:g.Nj})]}),(0,b.jsxs)(m.Tr,{children:[(0,b.jsx)(m.Td,{fontWeight:700,children:"Target"}),(0,b.jsx)(m.Td,{children:(0,b.jsx)(T,{status:null===a||void 0===a||null===(l=a.target)||void 0===l?void 0:l.status})}),(0,b.jsx)(m.Td,{children:null!==(r=null===a||void 0===a||null===(s=a.base)||void 0===s?void 0:s.message)&&void 0!==r?r:g.Nj})]})]})]})})}var C=t(1971);function k(n){var e,t,i,l,r,s,a=n.data;return(0,b.jsx)(m.xJ,{children:(0,b.jsxs)(m.iA,{variant:"simple",children:[(0,b.jsx)(m.hr,{children:(0,b.jsxs)(m.Tr,{children:[(0,b.jsx)(m.Th,{}),(0,b.jsx)(m.Th,{children:"Status"}),(0,b.jsx)(m.Th,{children:"Expected"}),(0,b.jsx)(m.Th,{children:"Actual"})]})}),(0,b.jsxs)(m.p3,{children:[(0,b.jsxs)(m.Tr,{children:[(0,b.jsx)(m.Td,{fontWeight:700,children:"Base"}),(0,b.jsx)(m.Td,{children:(0,b.jsx)(T,{status:null===a||void 0===a||null===(e=a.base)||void 0===e?void 0:e.status})}),(0,b.jsx)(m.Td,{children:(0,C.sG)(null===a||void 0===a||null===(t=a.base)||void 0===t?void 0:t.expected)}),(0,b.jsx)(m.Td,{children:(0,C.sG)(null===a||void 0===a||null===(i=a.base)||void 0===i?void 0:i.actual)})]}),(0,b.jsxs)(m.Tr,{children:[(0,b.jsx)(m.Td,{fontWeight:700,children:"Target"}),(0,b.jsx)(m.Td,{children:(0,b.jsx)(T,{status:null===a||void 0===a||null===(l=a.target)||void 0===l?void 0:l.status})}),(0,b.jsx)(m.Td,{children:(0,C.sG)(null===a||void 0===a||null===(r=a.target)||void 0===r?void 0:r.expected)}),(0,b.jsx)(m.Td,{children:(0,C.sG)(null===a||void 0===a||null===(s=a.target)||void 0===s?void 0:s.actual)})]})]})]})})}var S=["data","type","isOpen","onClose"];function N(n){var e=n.data,t=n.type,l=void 0===t?"piperider":t,r=n.isOpen,a=n.onClose,o=(0,j.Z)(n,S);return(0,b.jsxs)(f.u_,(0,i.Z)((0,i.Z)({},o),{},{isOpen:r,size:"2xl",onClose:function(){a()},children:[(0,b.jsx)(f.ZA,{}),(0,b.jsxs)(f.hz,{children:[(0,b.jsx)(f.xB,{children:(0,b.jsx)(s.xv,{title:null===e||void 0===e?void 0:e.name,noOfLines:1,maxWidth:"calc(100% - 50px)",children:null===e||void 0===e?void 0:e.name})}),(0,b.jsx)(f.ol,{}),(0,b.jsx)(f.fe,{children:"piperider"===l?(0,b.jsx)(k,{data:e}):(0,b.jsx)(y,{data:e})}),(0,b.jsx)(f.mz,{children:(0,b.jsx)(p.zx,{onClick:a,children:"Close"})})]})]}))}var _=t(6523),O=t(922),w=t(8453),Z=t(9227),P=t(9842),A=["base","target"];function W(n){var e=n.data,t=(0,u.useRef)(null),i=(0,u.useRef)(null);return function(n){var e=n.target,t=n.data,i=n.dimensions;(0,u.useEffect)((function(){if(e&&i&&t){var n=Z.Ys(e.current),l=t.map((function(n){return n.label||""})),r=Z.tiA().domain(l).range([0,i.width]).padding(.2),s=Z.tiA().domain(A).range([0,r.bandwidth()]).padding(.05),a=Z.LLu(r).tickFormat((function(n,e){var t=r.domain().length-1;return 0===e||e===t/2||e===t?n:""}));n.select(".x-axis").style("transform","translateY(".concat(i.height,"px)")).call(a);var o=Z.BYU().domain([0,Z.Fp7(t,(function(n){var e=n.base,t=n.target;return Math.max(e,t)}))]).range([i.height,0]),d=Z.y4O(o);n.select(".y-axis").call(d);var u=Z.PKp().domain(A).range(["var(--chakra-colors-blue-100)","var(--chakra-colors-blue-300)"]),c=n.selectAll(".grouped-chart").data(t).join("g").attr("class","grouped-chart").attr("transform",(function(n){return"translate(".concat(r(n.label),", 0)")})),v=(0,P.v)({target:".chart"});return c.selectAll("rect").data((function(n){return A.map((function(e){return{key:e,label:n.label,value:n[e]}}))})).enter().append("rect").attr("x",(function(n){return s(n.key)})).attr("y",(function(n){return o(n.value)})).attr("width",(function(n){return s.bandwidth()})).attr("height",(function(n){return i.height-o(n.value)})).attr("fill",(function(n){return u(n.key)})),c.selectAll(".overlay-bars").data((function(n){return A.map((function(e){return{key:e,label:n.label,value:n[e]}}))})).join("rect").attr("class","overlay-bars").attr("x",(function(n){return s(n.key)})).attr("y",(function(){return 0})).attr("width",s.bandwidth()).attr("height",(function(){return i.height})).attr("fill",(function(n){return u(n.key)})).style("opacity",0).on("mouseover",(function(n,e){v.html("\n        <div>\n          <p>Label: ".concat(e.label,"</p>\n          <p>Count: ").concat((0,C.uf)(e.value),"</p>\n        </div>\n      ")).transition().duration(500).style("visibility","visible"),Z.Ys(this).style("fill","var(--chakra-colors-gray-500)").style("opacity",.3)})).on("mousemove",(function(n){v.style("top","".concat(n.pageY-10,"px")).style("left","".concat(n.pageX+10,"px"))})).on("mouseout",(function(){v.html("").transition().duration(500).style("visibility","hidden"),Z.Ys(this).style("opacity",0)})),function(){n.select("svg").remove()}}}),[t,i,e])}({target:t,data:e,dimensions:(0,w.y)(i)}),(0,b.jsx)(s.kC,{className:"chart",width:"100%",ref:i,children:(0,b.jsxs)("svg",{width:"100%",overflow:"visible",ref:t,children:[(0,b.jsx)("g",{className:"x-axis"}),(0,b.jsx)("g",{className:"y-axis"})]})})}function E(n){var e=n.name,t=n.firstSlot,i=n.secondSlot,l=n.firstSlotWidth,r=void 0===l?"100px":l,a=n.secondSlotWidth,o=void 0===a?"100px":a;return(0,b.jsxs)(s.kC,{justifyContent:"space-between",children:[(0,b.jsx)(s.xv,{fontWeight:700,children:e}),(0,b.jsxs)(s.kC,{gap:{lg:5,md:1},children:[(0,b.jsx)(s.xv,{textAlign:"right",width:r,noOfLines:1,children:t}),i&&(0,b.jsx)(s.xv,{textAlign:"right",width:o,children:i})]})]})}function z(n){var e=n.baseColumn,t=n.targetColumn;if(e){(0,_.h5)(_.a$.safeParse(e));var i=e.nulls,l=e.total,r=e.valids,s=e.invalids,a=(0,O.gQ)(e),o=a.totalOfTotal,d=a.distinctOfTotal,u=a.invalidsOfTotal,c=a.validsOfTotal,v=a.nullsOfTotal}if(t){var h=t.total;_.a$.parse(t);var x=(0,O.gQ)(t),j=x.invalidsOfTotal,f=x.distinctOfTotal,p=x.validsOfTotal,m=x.nullsOfTotal}var T=null===t;return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(E,{name:"Total",firstSlot:(0,C.uy)(l,C.uf),secondSlot:T?g.Nj:(0,C.uy)(t?h:o,t?C.uf:C.Zn)}),(0,b.jsx)(E,{name:"Valid",firstSlot:(0,C.uy)(t?c:r,t?C.Zn:C.uf),secondSlot:T?g.Nj:(0,C.uy)(t?p:c,C.Zn)}),(0,b.jsx)(E,{name:"Mismatched",firstSlot:(0,C.uy)(t?u:s,t?C.Zn:C.uf),secondSlot:T?g.Nj:(0,C.uy)(t?j:u,C.Zn)}),(0,b.jsx)(E,{name:"Missing",firstSlot:(0,C.uy)(t?v:i,t?C.Zn:C.uf),secondSlot:T?g.Nj:(0,C.uy)(t?m:v,C.Zn)}),(0,b.jsx)(E,{name:"Distinct",firstSlot:(0,C.uy)(null===e||void 0===e?void 0:e.distinct,C.uf),secondSlot:T?g.Nj:(0,C.uy)(t?f:d,C.Zn)})]})}function I(n){var e=n.baseColumn,t=n.targetColumn,i=null===t,l=void 0===t;return(0,_.h5)(_.a$.safeParse(e)),(0,_.h5)(_.a$.safeParse(e)),(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(s.kC,{direction:"column",children:[(0,b.jsx)(E,{name:"Average",firstSlot:(0,C.uy)(null===e||void 0===e?void 0:e.avg,C.uf),secondSlot:i?g.Nj:l?void 0:(0,C.uy)(null===t||void 0===t?void 0:t.avg,C.uf)}),(0,b.jsx)(E,{name:"Std. Deviation",firstSlot:(0,C.uy)(null===e||void 0===e?void 0:e.stddev,C.uf),secondSlot:i?g.Nj:l?void 0:(0,C.uy)(null===t||void 0===t?void 0:t.stddev,C.uf)})]}),(0,b.jsxs)(s.kC,{direction:"column",children:[(0,b.jsx)(E,{name:"Min",firstSlot:(0,C.uy)(null===e||void 0===e?void 0:e.min,C.uf),secondSlot:i?g.Nj:l?void 0:(0,C.uy)(null===t||void 0===t?void 0:t.min,C.uf)}),(0,b.jsx)(E,{name:"5%",firstSlot:(0,C.uy)(null===e||void 0===e?void 0:e.p5,C.uf),secondSlot:i?g.Nj:l?void 0:(0,C.uy)(null===t||void 0===t?void 0:t.p5,C.uf)}),(0,b.jsx)(E,{name:"25%",firstSlot:(0,C.uy)(null===e||void 0===e?void 0:e.p25,C.uf),secondSlot:i?g.Nj:l?void 0:(0,C.uy)(null===t||void 0===t?void 0:t.p25,C.uf)}),(0,b.jsx)(E,{name:"50%",firstSlot:(0,C.uy)(null===e||void 0===e?void 0:e.p50,C.uf),secondSlot:i?g.Nj:l?void 0:(0,C.uy)(null===t||void 0===t?void 0:t.p50,C.uf)}),(0,b.jsx)(E,{name:"75%",firstSlot:(0,C.uy)(null===e||void 0===e?void 0:e.p75,C.uf),secondSlot:i?g.Nj:l?void 0:(0,C.uy)(null===t||void 0===t?void 0:t.p75,C.uf)}),(0,b.jsx)(E,{name:"95%",firstSlot:(0,C.uy)(null===e||void 0===e?void 0:e.p95,C.uf),secondSlot:i?g.Nj:l?void 0:(0,C.uy)(null===t||void 0===t?void 0:t.p95,C.uf)}),(0,b.jsx)(E,{name:"Max",firstSlot:(0,C.uy)(null===e||void 0===e?void 0:e.max,C.uf),secondSlot:i?g.Nj:l?void 0:(0,C.uy)(null===t||void 0===t?void 0:t.max,C.uf)})]})]})}var L=function(n){var e,t,i,l,r=n.baseColumn,a=n.targetColumn,o=r||a;return(0,_.h5)(_.a$.safeParse(r)),(0,_.h5)(_.a$.safeParse(a)),(0,b.jsx)(s.kC,{direction:"column",gap:2,minH:"250px",children:(0,b.jsxs)(s.kC,{direction:"column",gap:3,children:[(0,b.jsxs)(s.kC,{justifyContent:"space-between",children:[(0,b.jsxs)(s.xv,{maxWidth:"calc(100% - 250px)",children:[(0,b.jsx)(s.xv,{as:"span",fontWeight:700,color:"gray.900",fontSize:"lg",mr:1,noOfLines:1,title:null===o||void 0===o?void 0:o.name,children:null===o||void 0===o?void 0:o.name}),"","(",(0,b.jsx)(s.EK,{children:null===o||void 0===o?void 0:o.schema_type}),")"]}),(0,b.jsxs)(s.kC,{gap:8,children:[(0,b.jsx)(s.xv,{fontWeight:700,textAlign:"right",width:"100px",children:"Base"}),(0,b.jsx)(s.xv,{fontWeight:700,textAlign:"right",width:"100px",children:"Target"})]})]}),(0,b.jsx)(s.kC,{direction:"column",mt:3,children:(0,b.jsx)(z,{baseColumn:r,targetColumn:a||null})}),"numeric"===(null===r||void 0===r?void 0:r.type)&&(0,b.jsx)(b.Fragment,{children:(0,b.jsx)(I,{baseColumn:r,targetColumn:a||null})}),"datetime"===(null===r||void 0===r?void 0:r.type)&&(0,b.jsxs)(s.kC,{direction:"column",children:[(0,b.jsx)(E,{name:"Min",firstSlot:null!==(e=null===r||void 0===r?void 0:r.min)&&void 0!==e?e:g.Nj,secondSlot:null!==(t=null===a||void 0===a?void 0:a.min)&&void 0!==t?t:g.Nj}),(0,b.jsx)(E,{name:"Max",firstSlot:null!==(i=null===r||void 0===r?void 0:r.max)&&void 0!==i?i:g.Nj,secondSlot:null!==(l=null===a||void 0===a?void 0:a.max)&&void 0!==l?l:g.Nj})]})]})})};function Y(n){var e=n.baseTable,t=n.targetTable;(0,_.h5)(_.vT.safeParse(e)),(0,_.h5)(_.vT.safeParse(t));var i=(0,O.WN)(null===e||void 0===e?void 0:e.columns,null===t||void 0===t?void 0:t.columns);return(0,b.jsx)(b.Fragment,{children:Object.entries(i).map((function(n){var e=(0,l.Z)(n,2),t=e[0],i=e[1];return(0,b.jsx)(G,{name:t,base:null===i||void 0===i?void 0:i.base,target:null===i||void 0===i?void 0:i.target},t)}))})}function G(n){var e=n.name,t=n.base,i=n.target,r=(0,u.useState)([]),a=(0,l.Z)(r,2),o=a[0],d=a[1];(0,u.useEffect)((function(){if((null===t||void 0===t?void 0:t.type)!==(null===i||void 0===i?void 0:i.type)||"string"!==(null===t||void 0===t?void 0:t.type)&&"datetime"!==(null===t||void 0===t?void 0:t.type)){var n,e,l,r,s=t?(0,O.wY)({baseCounts:null===t||void 0===t||null===(n=t.histogram)||void 0===n?void 0:n.counts,baseLabels:null===t||void 0===t||null===(e=t.histogram)||void 0===e?void 0:e.labels}):null,a=i?(0,O.wY)({baseCounts:null===i||void 0===i||null===(l=i.histogram)||void 0===l?void 0:l.counts,baseLabels:null===i||void 0===i||null===(r=i.histogram)||void 0===r?void 0:r.labels}):null;d([s,a])}else{var o=(0,O.G_)({base:null===t||void 0===t?void 0:t.histogram,target:null===i||void 0===i?void 0:i.histogram});d([o])}}),[t,i]);var c=1===o.length;return(0,b.jsx)(s.kC,{direction:"column",children:(0,b.jsxs)(s.rj,{my:8,templateColumns:"500px 1fr",gap:12,children:[(0,b.jsx)(L,{baseColumn:t,targetColumn:i}),(0,b.jsxs)(s.rj,{my:4,templateColumns:"1fr ".concat(c?"":"1fr"),gap:c?0:12,children:[o[0]?(0,b.jsx)(W,{data:o[0]}):(0,b.jsx)(R,{}),o[1]?(0,b.jsx)(W,{data:o[1]}):c?null:(0,b.jsx)(R,{})]})]})},e)}function R(){return(0,b.jsx)(s.kC,{alignItems:"center",justifyContent:"center",color:"gray.500",children:"No data available"})}var F=t(2982),M=t(5984),V=function(n,e){return n?Object.entries(n).map((function(n){var t=(0,l.Z)(n,2),r=t[0],s=t[1];return(0,i.Z)((0,i.Z)({},s),{},{key:r,type:e,changed:!1})})):[]};function D(n){var e=n.base,t=n.target;(0,_.h5)(_.vT.safeParse(e)),(0,_.h5)(_.vT.safeParse(t));var l=V(null===e||void 0===e?void 0:e.columns,"base"),r=V(null===t||void 0===t?void 0:t.columns,"target"),a=[].concat((0,F.Z)(l),(0,F.Z)(r)),o=r.length-l.length,d=o<0?0:o,u=l.length-r.length,c=u<0?0:u,v=a.reduce((function(n,e,t){var r,s,o=t<l.length?t:t-l.length,d=t>=l.length?t:t+l.length,u=(null===(r=a[o])||void 0===r?void 0:r.schema_type)!==(null===(s=a[d])||void 0===s?void 0:s.schema_type),c=n.changed+(u?1:0),v=(0,i.Z)((0,i.Z)({},e),{},{name:e.name,changed:u});return(0,i.Z)((0,i.Z)({},n),{},{changed:c,columns:[].concat((0,F.Z)(n.columns),[v])})}),{added:d,deleted:c,changed:0,columns:[]}),h=v.added,x=v.deleted,j=v.changed,f=v.columns,p=f.slice(0,l.length),T=f.slice(l.length),y=B(p,T,o),C=B(T,p,u);return(0,b.jsxs)(s.kC,{direction:"column",children:[(0,b.jsxs)(s.xv,{mb:4,p:2,children:["Added:",(0,b.jsx)(s.xv,{as:"span",fontWeight:700,ml:1,children:h}),", Deleted:",(0,b.jsx)(s.xv,{as:"span",fontWeight:700,ml:1,children:x}),", Changed:"," ",(0,b.jsx)(s.xv,{as:"span",fontWeight:700,ml:1,children:j})]}),(0,b.jsxs)(s.kC,{justifyContent:"space-evenly",children:[(0,b.jsx)(m.xJ,{width:"50%",children:(0,b.jsxs)(m.iA,{variant:"simple",children:[(0,b.jsx)(m.hr,{children:(0,b.jsxs)(m.Tr,{children:[(0,b.jsx)(m.Th,{children:"Column"}),(0,b.jsx)(m.Th,{children:"Type"})]})}),(0,b.jsx)(m.p3,{children:y.map((function(n){var e,t;return(0,b.jsxs)(m.Tr,{color:null!==n&&void 0!==n&&n.changed?"red.500":"inherit",children:[(0,b.jsx)(m.Td,{children:null!==(e=null===n||void 0===n?void 0:n.name)&&void 0!==e?e:g.Nj}),(0,b.jsx)(m.Td,{children:null!==(t=null===n||void 0===n?void 0:n.schema_type)&&void 0!==t?t:g.Nj})]},(0,M.x0)(10))}))})]})}),(0,b.jsx)(s.kC,{justifyContent:"center",children:(0,b.jsx)(s.iz,{orientation:"vertical"})}),(0,b.jsx)(m.xJ,{width:"50%",children:(0,b.jsxs)(m.iA,{variant:"simple",children:[(0,b.jsx)(m.hr,{children:(0,b.jsxs)(m.Tr,{children:[(0,b.jsx)(m.Th,{children:"Column"}),(0,b.jsx)(m.Th,{children:"Type"})]})}),(0,b.jsx)(m.p3,{children:C.map((function(n){var e,t;return(0,b.jsxs)(m.Tr,{color:null!==n&&void 0!==n&&n.changed?"red.500":"inherit",children:[(0,b.jsx)(m.Td,{children:null!==(e=null===n||void 0===n?void 0:n.name)&&void 0!==e?e:g.Nj}),(0,b.jsx)(m.Td,{children:null!==(t=null===n||void 0===n?void 0:n.schema_type)&&void 0!==t?t:g.Nj})]},(0,M.x0)(10))}))})]})})]})]})}function B(n,e,t){return n.length<e.length?[].concat((0,F.Z)(n),(0,F.Z)(Array(t).fill(null))):n}var J=t(8444),X=t.n(J),K=["base","target"];function $(n){var e=n.base,t=void 0===e?[]:e,i=n.target,l=void 0===i?[]:i,r=(0,j.Z)(n,K),a=X()([].concat((0,F.Z)(t),(0,F.Z)(l)),(function(n){return"".concat(n.level,"_").concat(n.column,"_").concat(n.name)})),o=Object.values(a).map((function(n){var e={level:n[0].level,column:n[0].column,name:n[0].name};return n.forEach((function(n){"base"===n.from?e.base=n:e.target=n})),e}));return 0===o.length?(0,b.jsx)(s.kC,{direction:"column",children:(0,b.jsx)(s.xv,{textAlign:"center",children:"No tests available"})}):(0,b.jsx)(m.xJ,{children:(0,b.jsxs)(m.iA,{variant:"simple",children:[(0,b.jsx)(m.hr,{children:(0,b.jsxs)(m.Tr,{children:[(0,b.jsx)(m.Th,{children:"Level"}),(0,b.jsx)(m.Th,{children:"Column"}),(0,b.jsx)(m.Th,{children:"Assertion"}),(0,b.jsx)(m.Th,{children:"Base Status"}),(0,b.jsx)(m.Th,{children:"Target Status"}),(0,b.jsx)(m.Th,{})]})}),(0,b.jsx)(m.p3,{children:Object.values(o).map((function(n){var e,t;return(0,b.jsxs)(m.Tr,{children:[(0,b.jsx)(m.Td,{children:n.level}),(0,b.jsx)(m.Td,{children:n.column}),(0,b.jsx)(m.Td,{children:n.name}),(0,b.jsx)(m.Td,{children:(0,b.jsx)(T,{status:null===(e=n.base)||void 0===e?void 0:e.status})}),(0,b.jsx)(m.Td,{children:(0,b.jsx)(T,{status:null===(t=n.target)||void 0===t?void 0:t.status})}),(0,b.jsx)(m.Td,{onClick:function(){r.onDetailVisible(n)},children:(0,b.jsx)(s.xv,{as:"span",cursor:"pointer",children:"\ud83d\udd0d"})})]},(0,M.x0)())}))})]})})}function Q(n){var e,t,i,l,r,a,o=n.baseTable,d=n.targetTable;(0,_.h5)(_.vT.safeParse(o)),(0,_.h5)(_.vT.safeParse(d));var u=(0,v.YI)(null===o||void 0===o?void 0:o.piperider_assertion_result,null===o||void 0===o?void 0:o.dbt_assertion_result),c=(0,v.YI)(null===d||void 0===d?void 0:d.piperider_assertion_result,null===d||void 0===d?void 0:d.dbt_assertion_result);return(0,b.jsx)(m.xJ,{children:(0,b.jsxs)(m.iA,{variant:"simple",children:[(0,b.jsx)(m.hr,{children:(0,b.jsxs)(m.Tr,{children:[(0,b.jsx)(m.Th,{width:"10%"}),(0,b.jsx)(m.Th,{width:"45%",children:"Base"}),(0,b.jsx)(m.Th,{width:"45%",children:"Target"})]})}),(0,b.jsxs)(m.p3,{children:[(0,b.jsxs)(m.Tr,{children:[(0,b.jsx)(m.Td,{children:"Table"}),(0,b.jsx)(m.Td,{children:null!==(e=null===o||void 0===o?void 0:o.name)&&void 0!==e?e:g.Nj}),(0,b.jsx)(m.Td,{children:null!==(t=null===d||void 0===d?void 0:d.name)&&void 0!==t?t:g.Nj})]}),(0,b.jsxs)(m.Tr,{children:[(0,b.jsx)(m.Td,{children:"Rows"}),(0,b.jsx)(m.Td,{children:null!==(i=null===o||void 0===o?void 0:o.row_count)&&void 0!==i?i:g.Nj}),(0,b.jsx)(m.Td,{children:null!==(l=null===d||void 0===d?void 0:d.row_count)&&void 0!==l?l:g.Nj})]}),(0,b.jsxs)(m.Tr,{children:[(0,b.jsx)(m.Td,{children:"Columns"}),(0,b.jsx)(m.Td,{children:null!==(r=null===o||void 0===o?void 0:o.col_count)&&void 0!==r?r:g.Nj}),(0,b.jsx)(m.Td,{children:null!==(a=null===d||void 0===d?void 0:d.col_count)&&void 0!==a?a:g.Nj})]}),(0,b.jsxs)(m.Tr,{children:[(0,b.jsx)(m.Td,{children:"Test status"}),(0,b.jsx)(m.Td,{children:(0,b.jsxs)(s.xv,{children:[(0,b.jsxs)(s.xv,{as:"span",fontWeight:700,children:[u.passed," "]}),"Passed",", ",(0,b.jsxs)(s.xv,{as:"span",fontWeight:700,color:u.failed>0?"red.500":"inherit",children:[u.failed," "]}),"Failed"]})}),(0,b.jsx)(m.Td,{children:(0,b.jsxs)(s.xv,{children:[(0,b.jsxs)(s.xv,{as:"span",fontWeight:700,children:[c.passed," "]}),"Passed",", ",(0,b.jsxs)(s.xv,{as:"span",fontWeight:700,color:c.failed>0?"red.500":"inherit",children:[c.failed," "]}),"Failed"]})})]})]})]})})}function H(n){var e,t=n.data,j=n.name,f=(0,u.useState)(null),p=(0,l.Z)(f,2),m=p[0],g=p[1],T=(0,r.qY)(),y=t.base,C=t.input;(0,_.h5)((0,_.C6)(!0).safeParse(t));var k=y.tables[j],S=C.tables[j],O=null===(e=y.tables[j])||void 0===e?void 0:e.dbt_assertion_result;(0,_.h5)(_.vT.safeParse(k)),(0,_.h5)(_.vT.safeParse(S));var w=(0,v.Ix)({data:t,reportName:j,type:"piperider"}),Z=(0,l.Z)(w,2),P=Z[0],A=Z[1],W=(0,v.Ix)({data:t,reportName:j,type:"dbt"}),E=(0,l.Z)(W,2),z=E[0],I=E[1];return(0,h.j)(j),(0,b.jsxs)(c.o,{children:[(0,b.jsxs)(s.kC,{direction:"column",minH:"calc(100vh + 1px)",width:"100%",children:[(0,b.jsx)(s.kC,{mx:"10%",mt:4,children:(0,b.jsxs)(a.aG,{fontSize:"lg",children:[(0,b.jsx)(a.gN,{children:(0,b.jsx)(d.rU,{href:"/",children:(0,b.jsx)(a.At,{href:"/","data-cy":"cr-report-breadcrumb-back",children:"Tables"})})}),(0,b.jsx)(a.gN,{isCurrentPage:!0,children:(0,b.jsx)(a.At,{href:"#",children:j})})]})}),(0,b.jsxs)(s.kC,{border:"1px solid",borderColor:"gray.300",bg:"white",borderRadius:"md",p:6,mt:3,mx:"10%",direction:"column",gap:8,children:[(0,b.jsx)(s.X6,{fontSize:24,children:"Overview"}),(0,b.jsx)(Q,{baseTable:k,targetTable:S}),(0,b.jsxs)(o.mQ,{isLazy:!0,children:[(0,b.jsxs)(o.td,{children:[(0,b.jsx)(o.OK,{onClick:function(){(0,x._)({eventName:x.X.PAGE_VIEW,eventProperties:{type:"comparison-report",tab:"Schema"}})},children:"Schema"}),(0,b.jsx)(o.OK,{"data-cy":"cr-report-tab-item-profiling",onClick:function(){(0,x._)({eventName:x.X.PAGE_VIEW,eventProperties:{type:"comparison-report",tab:"Profiling"}})},children:"Profiling"}),(0,b.jsx)(o.OK,{"data-cy":"cr-report-tab-item-tests",onClick:function(){(0,x._)({eventName:x.X.PAGE_VIEW,eventProperties:{type:"comparison-report",tab:"Tests"}})},children:"Tests"}),O&&(0,b.jsx)(o.OK,{onClick:function(){(0,x._)({eventName:x.X.PAGE_VIEW,eventProperties:{type:"comparison-report",tab:"dbt Tests"}})},children:"dbt Tests"})]}),(0,b.jsxs)(o.nP,{children:[(0,b.jsx)(o.x4,{children:(0,b.jsx)(D,{base:k,target:S})}),(0,b.jsx)(o.x4,{children:(0,b.jsx)(Y,{baseTable:k,targetTable:S})}),(0,b.jsx)(o.x4,{children:(0,b.jsx)($,{base:null===P||void 0===P?void 0:P.tests,target:null===A||void 0===A?void 0:A.tests,onDetailVisible:function(n){g({type:"piperider",data:n}),T.onOpen()}})}),(0,b.jsx)(o.x4,{children:0===(null===z||void 0===z?void 0:z.tests.length)&&0===(null===I||void 0===I?void 0:I.tests.length)?(0,b.jsx)(s.kC,{justifyContent:"center",alignItems:"center",height:"100px",children:(0,b.jsx)(s.xv,{color:"gray.500",children:"No dbt tests available."})}):(0,b.jsx)($,{base:null===z||void 0===z?void 0:z.tests,target:null===I||void 0===I?void 0:I.tests,onDetailVisible:function(n){g({type:"dbt",data:n}),T.onOpen()}})})]})]})]})]}),(0,b.jsx)(N,(0,i.Z)((0,i.Z)({},T),{},{type:null===m||void 0===m?void 0:m.type,data:null===m||void 0===m?void 0:m.data,onClose:function(){T.onClose(),g(null)}}))]})}},8453:function(n,e,t){t.d(e,{y:function(){return r}});var i=t(885),l=t(2791);function r(n){var e=(0,l.useState)(null),t=(0,i.Z)(e,2),r=t[0],s=t[1];return(0,l.useEffect)((function(){if(n&&n.current){var e=n.current,t=new ResizeObserver((function(n){n.forEach((function(n){s(n.contentRect)}))}));return t.observe(e),function(){t.unobserve(e)}}}),[n]),r}},3442:function(n,e,t){t.d(e,{X:function(){return l},_:function(){return r}});var i=t(8083),l={PAGE_VIEW:"Page View"};function r(n){var e=n.eventName,t=n.eventProperties,l=n.eventOptions;return window.PIPERIDER_METADATA.amplitude_api_key?(0,i.j)(e,t,l):console.info({eventName:e,eventProperties:t,eventOptions:l})}},9842:function(n,e,t){t.d(e,{p:function(){return h},v:function(){return v}});var i=t(9227),l=t(2387),r="var(--chakra-space-2)",s="var(--chakra-space-2)",a="var(--chakra-space-4)",o="var(--chakra-space-4)",d="var(--chakra-radii-md)",u="var(--chakra-colors-white)",c="var(--chakra-colors-blackAlpha-700)";function v(n){var e=n.target,t=n.style,l=void 0===t?{}:t;return i.Ys(e).append("div").attr("class","chart_tooltip").style("visibility","hidden").style("position","absolute").style("z-index","1501").style("padding-top",(null===l||void 0===l?void 0:l.paddingTop)||r).style("padding-bottom",(null===l||void 0===l?void 0:l.paddingBottom)||s).style("border-radius",(null===l||void 0===l?void 0:l.borderRadius)||d).style("padding-left",(null===l||void 0===l?void 0:l.paddingLeft)||a).style("padding-right",(null===l||void 0===l?void 0:l.paddingRight)||o).style("color",(null===l||void 0===l?void 0:l.color)||u).style("background-color",(null===l||void 0===l?void 0:l.backgroundColor)||c)}function h(n){var e=n.type;return n.isCategorical?l.bF:"string"===e?l.d4:"boolean"===e?l.RW:"datetime"===e?l.qI:l.E5}},922:function(n,e,t){t.d(e,{G_:function(){return s},JH:function(){return d},WN:function(){return r},cc:function(){return u},gQ:function(){return o},wY:function(){return a}});var i=t(2982),l=t(885);function r(n,e){var t={};return Object.entries(n||{}).forEach((function(n){var e=(0,l.Z)(n,2),i=e[0],r=e[1];t[i]||(t[i]={}),t[i].base=r})),Object.entries(e||{}).forEach((function(n){var e=(0,l.Z)(n,2),i=e[0],r=e[1];t[i]||(t[i]={}),t[i].target=r})),t}function s(n){var e=n.base,t=n.target,l=new Map;if(!e||!t)return null;var r=e.labels.map((function(n,t){return l.set(n||String(t),t),{label:n,base:e.counts[t],target:0}}));return t.labels.reduce((function(n,e,r){var s=e||String(r),a=l.has(s),o=t.counts[r];if(a)return n[l.get(s)].target=o,n;var d={label:e,base:0,target:o};return[].concat((0,i.Z)(n),[d])}),r)}function a(n){var e=n.baseCounts,t=n.baseLabels;return t&&e?e.map((function(n,e){return{label:t[e],base:n,target:0}})):null}function o(n){var e=n.nulls,t=n.non_nulls,i=n.total,l=n.invalids,r=n.distinct,s=n.valids,a=n.non_duplicates,o=n.duplicates,d=n.zero_length,u=n.negatives,c=n.zeros;return{negativesOfTotal:u&&i?u/i:null,zerosOfTotal:c&&i?c/i:null,hasNoNull:t===i,zeroLengthOfTotal:d&&i?d/i:null,distinctOfTotal:r&&i?r/i:null,validsOfTotal:s&&i?s/i:null,invalidsOfTotal:l&&i?l/i:null,nullsOfTotal:e&&i?e/i:null,duplicatesOfTotal:o&&i?o/i:null,nonDuplicatesOfTotal:a&&i?a/i:null,totalOfTotal:i?i/i:null}}function d(n){var e=n.distinct,t=n.type;return"number"===typeof e&&(e<=100&&("string"===t||"integer"===t))}function u(n){var e=n.topk,t=n.histogram,i=n.trues,l=n.falses,r=n.type,s=n.total,a=d(n),o="boolean"===r,u=a?null===e||void 0===e?void 0:e.values:o?["TRUES","FALSES"]:null===t||void 0===t?void 0:t.labels,c=a?null===e||void 0===e?void 0:e.counts:o?[i,l]:null===t||void 0===t?void 0:t.counts;if(u&&c&&s)return u.map((function(n,e){return{label:n,isCategorical:a,value:c[e],type:r,total:s}}))}}}]);
//# sourceMappingURL=266.ca8c076f.chunk.js.map