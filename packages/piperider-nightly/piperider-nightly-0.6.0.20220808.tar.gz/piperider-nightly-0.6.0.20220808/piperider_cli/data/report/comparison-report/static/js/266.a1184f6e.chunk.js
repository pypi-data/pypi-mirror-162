"use strict";(self.webpackChunkpiperider_report=self.webpackChunkpiperider_report||[]).push([[266],{6787:function(e,n,i){i.r(n),i.d(n,{default:function(){return q}});var t=i(1413),l=i(885),s=i(5223),r=i(8735),d=i(6837),o=i(4385),a=i(8625),c=i(2791),u=i(7260),v=i(6157),h=i(2483),x=i(3442),j=i(5987),f=i(1564),p=i(2504),m=i(7005),g=i(2387),b=i(184);function y(e){switch(e.status){case"passed":return(0,b.jsx)(r.xv,{as:"span",role:"img",children:"\u2705"});case"failed":return(0,b.jsx)(r.xv,{as:"span",role:"img",children:"\u274c"});default:return(0,b.jsx)(r.xv,{as:"span",role:"img",children:"-"})}}function T(e){var n,i,t,l,s,r,d=e.data;return(0,b.jsx)(m.xJ,{children:(0,b.jsxs)(m.iA,{variant:"simple",children:[(0,b.jsx)(m.hr,{children:(0,b.jsxs)(m.Tr,{children:[(0,b.jsx)(m.Th,{}),(0,b.jsx)(m.Th,{children:"Status"}),(0,b.jsx)(m.Th,{children:"Message"})]})}),(0,b.jsxs)(m.p3,{children:[(0,b.jsxs)(m.Tr,{children:[(0,b.jsx)(m.Td,{fontWeight:700,children:"Base"}),(0,b.jsx)(m.Td,{children:(0,b.jsx)(y,{status:null===d||void 0===d||null===(n=d.base)||void 0===n?void 0:n.status})}),(0,b.jsx)(m.Td,{children:null!==(i=null===d||void 0===d||null===(t=d.base)||void 0===t?void 0:t.message)&&void 0!==i?i:g.Nj})]}),(0,b.jsxs)(m.Tr,{children:[(0,b.jsx)(m.Td,{fontWeight:700,children:"Target"}),(0,b.jsx)(m.Td,{children:(0,b.jsx)(y,{status:null===d||void 0===d||null===(l=d.target)||void 0===l?void 0:l.status})}),(0,b.jsx)(m.Td,{children:null!==(s=null===d||void 0===d||null===(r=d.base)||void 0===r?void 0:r.message)&&void 0!==s?s:g.Nj})]})]})]})})}var C=i(1971);function k(e){var n,i,t,l,s,r,d=e.data;return(0,b.jsx)(m.xJ,{children:(0,b.jsxs)(m.iA,{variant:"simple",children:[(0,b.jsx)(m.hr,{children:(0,b.jsxs)(m.Tr,{children:[(0,b.jsx)(m.Th,{}),(0,b.jsx)(m.Th,{children:"Status"}),(0,b.jsx)(m.Th,{children:"Expected"}),(0,b.jsx)(m.Th,{children:"Actual"})]})}),(0,b.jsxs)(m.p3,{children:[(0,b.jsxs)(m.Tr,{children:[(0,b.jsx)(m.Td,{fontWeight:700,children:"Base"}),(0,b.jsx)(m.Td,{children:(0,b.jsx)(y,{status:null===d||void 0===d||null===(n=d.base)||void 0===n?void 0:n.status})}),(0,b.jsx)(m.Td,{children:(0,C.sG)(null===d||void 0===d||null===(i=d.base)||void 0===i?void 0:i.expected)}),(0,b.jsx)(m.Td,{children:(0,C.sG)(null===d||void 0===d||null===(t=d.base)||void 0===t?void 0:t.actual)})]}),(0,b.jsxs)(m.Tr,{children:[(0,b.jsx)(m.Td,{fontWeight:700,children:"Target"}),(0,b.jsx)(m.Td,{children:(0,b.jsx)(y,{status:null===d||void 0===d||null===(l=d.target)||void 0===l?void 0:l.status})}),(0,b.jsx)(m.Td,{children:(0,C.sG)(null===d||void 0===d||null===(s=d.target)||void 0===s?void 0:s.expected)}),(0,b.jsx)(m.Td,{children:(0,C.sG)(null===d||void 0===d||null===(r=d.target)||void 0===r?void 0:r.actual)})]})]})]})})}var S=["data","type","isOpen","onClose"];function N(e){var n=e.data,i=e.type,l=void 0===i?"piperider":i,s=e.isOpen,d=e.onClose,o=(0,j.Z)(e,S);return(0,b.jsxs)(f.u_,(0,t.Z)((0,t.Z)({},o),{},{isOpen:s,size:"2xl",onClose:function(){d()},children:[(0,b.jsx)(f.ZA,{}),(0,b.jsxs)(f.hz,{children:[(0,b.jsx)(f.xB,{children:(0,b.jsx)(r.xv,{title:null===n||void 0===n?void 0:n.name,noOfLines:1,maxWidth:"calc(100% - 50px)",children:null===n||void 0===n?void 0:n.name})}),(0,b.jsx)(f.ol,{}),(0,b.jsx)(f.fe,{children:"piperider"===l?(0,b.jsx)(k,{data:n}):(0,b.jsx)(T,{data:n})}),(0,b.jsx)(f.mz,{children:(0,b.jsx)(p.zx,{onClick:d,children:"Close"})})]})]}))}var _=i(6523),w=i(922),P=i(8453),Z=i(9227),A=i(9842),O=["base","target"];function W(e){var n=e.data,i=(0,c.useRef)(null),t=(0,c.useRef)(null);return function(e){var n=e.target,i=e.data,t=e.dimensions;(0,c.useEffect)((function(){if(n&&t&&i){var e=Z.Ys(n.current),l=i.map((function(e){return e.label||""})),s=Z.tiA().domain(l).range([0,t.width]).padding(.2),r=Z.tiA().domain(O).range([0,s.bandwidth()]).padding(.05),d=Z.LLu(s).tickFormat((function(e,n){var i=s.domain().length-1;return 0===n||n===i/2||n===i?e:""}));e.select(".x-axis").style("transform","translateY(".concat(t.height,"px)")).call(d);var o=Z.BYU().domain([0,Z.Fp7(i,(function(e){var n=e.base,i=e.target;return Math.max(n,i)}))]).range([t.height,0]),a=Z.y4O(o);e.select(".y-axis").call(a);var c=Z.PKp().domain(O).range(["var(--chakra-colors-blue-100)","var(--chakra-colors-blue-300)"]),u=e.selectAll(".grouped-chart").data(i).join("g").attr("class","grouped-chart").attr("transform",(function(e){return"translate(".concat(s(e.label),", 0)")})),v=(0,A.v)({target:".chart"});return u.selectAll("rect").data((function(e){return O.map((function(n){return{key:n,label:e.label,value:e[n]}}))})).enter().append("rect").attr("x",(function(e){return r(e.key)})).attr("y",(function(e){return o(e.value)})).attr("width",(function(e){return r.bandwidth()})).attr("height",(function(e){return t.height-o(e.value)})).attr("fill",(function(e){return c(e.key)})),u.selectAll(".overlay-bars").data((function(e){return O.map((function(n){return{key:n,label:e.label,value:e[n]}}))})).join("rect").attr("class","overlay-bars").attr("x",(function(e){return r(e.key)})).attr("y",(function(){return 0})).attr("width",r.bandwidth()).attr("height",(function(){return t.height})).attr("fill",(function(e){return c(e.key)})).style("opacity",0).on("mouseover",(function(e,n){v.html("\n        <div>\n          <p>Label: ".concat(n.label,"</p>\n          <p>Count: ").concat((0,C.uf)(n.value),"</p>\n        </div>\n      ")).transition().duration(500).style("visibility","visible"),Z.Ys(this).style("fill","var(--chakra-colors-gray-500)").style("opacity",.3)})).on("mousemove",(function(e){v.style("top","".concat(e.pageY-10,"px")).style("left","".concat(e.pageX+10,"px"))})).on("mouseout",(function(){v.html("").transition().duration(500).style("visibility","hidden"),Z.Ys(this).style("opacity",0)})),function(){e.select("svg").remove()}}}),[i,t,n])}({target:i,data:n,dimensions:(0,P.y)(t)}),(0,b.jsx)(r.kC,{className:"chart",width:"100%",ref:t,children:(0,b.jsxs)("svg",{width:"100%",overflow:"visible",ref:i,children:[(0,b.jsx)("g",{className:"x-axis"}),(0,b.jsx)("g",{className:"y-axis"})]})})}function E(e){var n=e.name,i=e.firstSlot,t=e.secondSlot,l=e.firstSlotWidth,s=void 0===l?"100px":l,d=e.secondSlotWidth,o=void 0===d?"100px":d;return(0,b.jsxs)(r.kC,{justifyContent:"space-between",children:[(0,b.jsx)(r.xv,{fontWeight:700,children:n}),(0,b.jsxs)(r.kC,{gap:{lg:5,md:1},children:[(0,b.jsx)(r.xv,{textAlign:"right",width:s,noOfLines:1,children:i}),t&&(0,b.jsx)(r.xv,{textAlign:"right",width:o,children:t})]})]})}function I(e){var n=e.baseColumn,i=e.targetColumn;if(n){(0,_.h5)(_.a$.safeParse(n));var t=n.nulls,l=n.total,s=n.valids,r=n.invalids,d=(0,w.gQ)(n),o=d.totalOfTotal,a=d.distinctOfTotal,c=d.invalidsOfTotal,u=d.validsOfTotal,v=d.nullsOfTotal}if(i){var h=i.total;_.a$.parse(i);var x=(0,w.gQ)(i),j=x.invalidsOfTotal,f=x.distinctOfTotal,p=x.validsOfTotal,m=x.nullsOfTotal}var y=null===i;return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(E,{name:"Total",firstSlot:(0,C.uy)(l,C.uf),secondSlot:y?g.Nj:(0,C.uy)(i?h:o,i?C.uf:C.Zn)}),(0,b.jsx)(E,{name:"Valid",firstSlot:(0,C.uy)(i?u:s,i?C.Zn:C.uf),secondSlot:y?g.Nj:(0,C.uy)(i?p:u,C.Zn)}),(0,b.jsx)(E,{name:"Mismatched",firstSlot:(0,C.uy)(i?c:r,i?C.Zn:C.uf),secondSlot:y?g.Nj:(0,C.uy)(i?j:c,C.Zn)}),(0,b.jsx)(E,{name:"Missing",firstSlot:(0,C.uy)(i?v:t,i?C.Zn:C.uf),secondSlot:y?g.Nj:(0,C.uy)(i?m:v,C.Zn)}),(0,b.jsx)(E,{name:"Distinct",firstSlot:(0,C.uy)(null===n||void 0===n?void 0:n.distinct,C.uf),secondSlot:y?g.Nj:(0,C.uy)(i?f:a,C.Zn)})]})}function Y(e){var n=e.baseColumn,i=e.targetColumn,t=null===i,l=void 0===i;return(0,_.h5)(_.a$.safeParse(n)),(0,_.h5)(_.a$.safeParse(n)),(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(r.kC,{direction:"column",children:[(0,b.jsx)(E,{name:"Average",firstSlot:(0,C.uy)(null===n||void 0===n?void 0:n.avg,C.uf),secondSlot:t?g.Nj:l?void 0:(0,C.uy)(null===i||void 0===i?void 0:i.avg,C.uf)}),(0,b.jsx)(E,{name:"Std. Deviation",firstSlot:(0,C.uy)(null===n||void 0===n?void 0:n.stddev,C.uf),secondSlot:t?g.Nj:l?void 0:(0,C.uy)(null===i||void 0===i?void 0:i.stddev,C.uf)})]}),(0,b.jsxs)(r.kC,{direction:"column",children:[(0,b.jsx)(E,{name:"Min",firstSlot:(0,C.uy)(null===n||void 0===n?void 0:n.min,C.uf),secondSlot:t?g.Nj:l?void 0:(0,C.uy)(null===i||void 0===i?void 0:i.min,C.uf)}),(0,b.jsx)(E,{name:"5%",firstSlot:(0,C.uy)(null===n||void 0===n?void 0:n.p5,C.uf),secondSlot:t?g.Nj:l?void 0:(0,C.uy)(null===i||void 0===i?void 0:i.p5,C.uf)}),(0,b.jsx)(E,{name:"25%",firstSlot:(0,C.uy)(null===n||void 0===n?void 0:n.p25,C.uf),secondSlot:t?g.Nj:l?void 0:(0,C.uy)(null===i||void 0===i?void 0:i.p25,C.uf)}),(0,b.jsx)(E,{name:"50%",firstSlot:(0,C.uy)(null===n||void 0===n?void 0:n.p50,C.uf),secondSlot:t?g.Nj:l?void 0:(0,C.uy)(null===i||void 0===i?void 0:i.p50,C.uf)}),(0,b.jsx)(E,{name:"75%",firstSlot:(0,C.uy)(null===n||void 0===n?void 0:n.p75,C.uf),secondSlot:t?g.Nj:l?void 0:(0,C.uy)(null===i||void 0===i?void 0:i.p75,C.uf)}),(0,b.jsx)(E,{name:"95%",firstSlot:(0,C.uy)(null===n||void 0===n?void 0:n.p95,C.uf),secondSlot:t?g.Nj:l?void 0:(0,C.uy)(null===i||void 0===i?void 0:i.p95,C.uf)}),(0,b.jsx)(E,{name:"Max",firstSlot:(0,C.uy)(null===n||void 0===n?void 0:n.max,C.uf),secondSlot:t?g.Nj:l?void 0:(0,C.uy)(null===i||void 0===i?void 0:i.max,C.uf)})]})]})}var z=function(e){var n,i,t,l,s=e.baseColumn,d=e.targetColumn,o=s||d;return(0,_.h5)(_.a$.safeParse(s)),(0,_.h5)(_.a$.safeParse(d)),(0,b.jsx)(r.kC,{direction:"column",gap:2,minH:"250px",children:(0,b.jsxs)(r.kC,{direction:"column",gap:3,children:[(0,b.jsxs)(r.kC,{justifyContent:"space-between",children:[(0,b.jsxs)(r.xv,{maxWidth:"calc(100% - 250px)",children:[(0,b.jsx)(r.xv,{as:"span",fontWeight:700,color:"gray.900",fontSize:"lg",mr:1,noOfLines:1,title:null===o||void 0===o?void 0:o.name,children:null===o||void 0===o?void 0:o.name}),"","(",(0,b.jsx)(r.EK,{children:null===o||void 0===o?void 0:o.schema_type}),")"]}),(0,b.jsxs)(r.kC,{gap:8,children:[(0,b.jsx)(r.xv,{fontWeight:700,textAlign:"right",width:"100px",children:"Base"}),(0,b.jsx)(r.xv,{fontWeight:700,textAlign:"right",width:"100px",children:"Target"})]})]}),(0,b.jsx)(r.kC,{direction:"column",mt:3,children:(0,b.jsx)(I,{baseColumn:s,targetColumn:d||null})}),"numeric"===(null===s||void 0===s?void 0:s.type)&&(0,b.jsx)(b.Fragment,{children:(0,b.jsx)(Y,{baseColumn:s,targetColumn:d||null})}),"datetime"===(null===s||void 0===s?void 0:s.type)&&(0,b.jsxs)(r.kC,{direction:"column",children:[(0,b.jsx)(E,{name:"Min",firstSlot:null!==(n=null===s||void 0===s?void 0:s.min)&&void 0!==n?n:g.Nj,secondSlot:null!==(i=null===d||void 0===d?void 0:d.min)&&void 0!==i?i:g.Nj}),(0,b.jsx)(E,{name:"Max",firstSlot:null!==(t=null===s||void 0===s?void 0:s.max)&&void 0!==t?t:g.Nj,secondSlot:null!==(l=null===d||void 0===d?void 0:d.max)&&void 0!==l?l:g.Nj})]})]})})};function G(e){var n=e.baseTable,i=e.targetTable;(0,_.h5)(_.vT.safeParse(n)),(0,_.h5)(_.vT.safeParse(i));var t=(0,w.WN)(null===n||void 0===n?void 0:n.columns,null===i||void 0===i?void 0:i.columns);return(0,b.jsx)(b.Fragment,{children:Object.entries(t).map((function(e){var n=(0,l.Z)(e,2),i=n[0],t=n[1];return(0,b.jsx)(L,{name:i,base:null===t||void 0===t?void 0:t.base,target:null===t||void 0===t?void 0:t.target},i)}))})}function L(e){var n=e.name,i=e.base,t=e.target,s=(0,c.useState)([]),d=(0,l.Z)(s,2),o=d[0],a=d[1];(0,c.useEffect)((function(){if((null===i||void 0===i?void 0:i.type)!==(null===t||void 0===t?void 0:t.type)||"string"!==(null===i||void 0===i?void 0:i.type)&&"datetime"!==(null===i||void 0===i?void 0:i.type)){var e,n,l,s,r=i?(0,w.wY)({baseCounts:null===i||void 0===i||null===(e=i.histogram)||void 0===e?void 0:e.counts,baseLabels:null===i||void 0===i||null===(n=i.histogram)||void 0===n?void 0:n.labels}):null,d=t?(0,w.wY)({baseCounts:null===t||void 0===t||null===(l=t.histogram)||void 0===l?void 0:l.counts,baseLabels:null===t||void 0===t||null===(s=t.histogram)||void 0===s?void 0:s.labels}):null;a([r,d])}else{var o=(0,w.G_)({base:null===i||void 0===i?void 0:i.histogram,target:null===t||void 0===t?void 0:t.histogram});a([o])}}),[i,t]);var u=1===o.length;return(0,b.jsx)(r.kC,{direction:"column",children:(0,b.jsxs)(r.rj,{my:8,templateColumns:"500px 1fr",gap:12,children:[(0,b.jsx)(z,{baseColumn:i,targetColumn:t}),(0,b.jsxs)(r.rj,{my:4,templateColumns:"1fr ".concat(u?"":"1fr"),gap:u?0:12,children:[o[0]?(0,b.jsx)(W,{data:o[0]}):(0,b.jsx)(R,{}),o[1]?(0,b.jsx)(W,{data:o[1]}):u?null:(0,b.jsx)(R,{})]})]})},n)}function R(){return(0,b.jsx)(r.kC,{alignItems:"center",justifyContent:"center",color:"gray.500",children:"No data available"})}var V=i(2982),F=i(5984),M=function(e,n){return e?Object.entries(e).map((function(e){var i=(0,l.Z)(e,2),s=i[0],r=i[1];return(0,t.Z)((0,t.Z)({},r),{},{key:s,type:n,changed:!1})})):[]};function B(e){var n=e.base,i=e.target;(0,_.h5)(_.vT.safeParse(n)),(0,_.h5)(_.vT.safeParse(i));var l=M(null===n||void 0===n?void 0:n.columns,"base"),s=M(null===i||void 0===i?void 0:i.columns,"target"),d=[].concat((0,V.Z)(l),(0,V.Z)(s)),o=s.length-l.length,a=o<0?0:o,c=l.length-s.length,u=c<0?0:c,v=d.reduce((function(e,n,i){var s,r,o=i<l.length?i:i-l.length,a=i>=l.length?i:i+l.length,c=(null===(s=d[o])||void 0===s?void 0:s.schema_type)!==(null===(r=d[a])||void 0===r?void 0:r.schema_type),u=e.changed+(c?1:0),v=(0,t.Z)((0,t.Z)({},n),{},{name:n.name,changed:c});return(0,t.Z)((0,t.Z)({},e),{},{changed:u,columns:[].concat((0,V.Z)(e.columns),[v])})}),{added:a,deleted:u,changed:0,columns:[]}),h=v.added,x=v.deleted,j=v.changed,f=v.columns,p=f.slice(0,l.length),y=f.slice(l.length),T=D(p,y,o),C=D(y,p,c);return(0,b.jsxs)(r.kC,{direction:"column",children:[(0,b.jsxs)(r.xv,{mb:4,p:2,children:["Added:",(0,b.jsx)(r.xv,{as:"span",fontWeight:700,ml:1,children:h}),", Deleted:",(0,b.jsx)(r.xv,{as:"span",fontWeight:700,ml:1,children:x}),", Changed:"," ",(0,b.jsx)(r.xv,{as:"span",fontWeight:700,ml:1,children:j})]}),(0,b.jsxs)(r.kC,{justifyContent:"space-evenly",children:[(0,b.jsx)(m.xJ,{width:"50%",children:(0,b.jsxs)(m.iA,{variant:"simple",children:[(0,b.jsx)(m.hr,{children:(0,b.jsxs)(m.Tr,{children:[(0,b.jsx)(m.Th,{children:"Column"}),(0,b.jsx)(m.Th,{children:"Type"})]})}),(0,b.jsx)(m.p3,{children:T.map((function(e){var n,i;return(0,b.jsxs)(m.Tr,{color:null!==e&&void 0!==e&&e.changed?"red.500":"inherit",children:[(0,b.jsx)(m.Td,{children:null!==(n=null===e||void 0===e?void 0:e.name)&&void 0!==n?n:g.Nj}),(0,b.jsx)(m.Td,{children:null!==(i=null===e||void 0===e?void 0:e.schema_type)&&void 0!==i?i:g.Nj})]},(0,F.x0)(10))}))})]})}),(0,b.jsx)(r.kC,{justifyContent:"center",children:(0,b.jsx)(r.iz,{orientation:"vertical"})}),(0,b.jsx)(m.xJ,{width:"50%",children:(0,b.jsxs)(m.iA,{variant:"simple",children:[(0,b.jsx)(m.hr,{children:(0,b.jsxs)(m.Tr,{children:[(0,b.jsx)(m.Th,{children:"Column"}),(0,b.jsx)(m.Th,{children:"Type"})]})}),(0,b.jsx)(m.p3,{children:C.map((function(e){var n,i;return(0,b.jsxs)(m.Tr,{color:null!==e&&void 0!==e&&e.changed?"red.500":"inherit",children:[(0,b.jsx)(m.Td,{children:null!==(n=null===e||void 0===e?void 0:e.name)&&void 0!==n?n:g.Nj}),(0,b.jsx)(m.Td,{children:null!==(i=null===e||void 0===e?void 0:e.schema_type)&&void 0!==i?i:g.Nj})]},(0,F.x0)(10))}))})]})})]})]})}function D(e,n,i){return e.length<n.length?[].concat((0,V.Z)(e),(0,V.Z)(Array(i).fill(null))):e}var X=i(8444),J=i.n(X),K=["base","target"];function $(e){var n=e.base,i=void 0===n?[]:n,t=e.target,l=void 0===t?[]:t,s=(0,j.Z)(e,K),d=J()([].concat((0,V.Z)(i),(0,V.Z)(l)),(function(e){return"".concat(e.level,"_").concat(e.column,"_").concat(e.name)})),o=Object.values(d).map((function(e){var n={level:e[0].level,column:e[0].column,name:e[0].name};return e.forEach((function(e){"base"===e.from?n.base=e:n.target=e})),n}));return 0===o.length?(0,b.jsx)(r.kC,{direction:"column",children:(0,b.jsx)(r.xv,{textAlign:"center",children:"No tests available"})}):(0,b.jsx)(m.xJ,{children:(0,b.jsxs)(m.iA,{variant:"simple",children:[(0,b.jsx)(m.hr,{children:(0,b.jsxs)(m.Tr,{children:[(0,b.jsx)(m.Th,{children:"Level"}),(0,b.jsx)(m.Th,{children:"Column"}),(0,b.jsx)(m.Th,{children:"Assertion"}),(0,b.jsx)(m.Th,{children:"Base Status"}),(0,b.jsx)(m.Th,{children:"Target Status"}),(0,b.jsx)(m.Th,{})]})}),(0,b.jsx)(m.p3,{children:Object.values(o).map((function(e){var n,i;return(0,b.jsxs)(m.Tr,{children:[(0,b.jsx)(m.Td,{children:e.level}),(0,b.jsx)(m.Td,{children:e.column}),(0,b.jsx)(m.Td,{children:e.name}),(0,b.jsx)(m.Td,{children:(0,b.jsx)(y,{status:null===(n=e.base)||void 0===n?void 0:n.status})}),(0,b.jsx)(m.Td,{children:(0,b.jsx)(y,{status:null===(i=e.target)||void 0===i?void 0:i.status})}),(0,b.jsx)(m.Td,{onClick:function(){s.onDetailVisible(e)},children:(0,b.jsx)(r.xv,{as:"span",cursor:"pointer",children:"\ud83d\udd0d"})})]},(0,F.x0)())}))})]})})}function Q(e){var n,i,t,l,s,d,o=e.baseTable,a=e.targetTable;(0,_.h5)(_.vT.safeParse(o)),(0,_.h5)(_.vT.safeParse(a));var c=(0,v.YI)(null===o||void 0===o?void 0:o.piperider_assertion_result,null===o||void 0===o?void 0:o.dbt_assertion_result),u=(0,v.YI)(null===a||void 0===a?void 0:a.piperider_assertion_result,null===a||void 0===a?void 0:a.dbt_assertion_result);return(0,b.jsx)(m.xJ,{children:(0,b.jsxs)(m.iA,{variant:"simple",children:[(0,b.jsx)(m.hr,{children:(0,b.jsxs)(m.Tr,{children:[(0,b.jsx)(m.Th,{width:"10%"}),(0,b.jsx)(m.Th,{width:"45%",children:"Base"}),(0,b.jsx)(m.Th,{width:"45%",children:"Target"})]})}),(0,b.jsxs)(m.p3,{children:[(0,b.jsxs)(m.Tr,{children:[(0,b.jsx)(m.Td,{children:"Table"}),(0,b.jsx)(m.Td,{children:null!==(n=null===o||void 0===o?void 0:o.name)&&void 0!==n?n:g.Nj}),(0,b.jsx)(m.Td,{children:null!==(i=null===a||void 0===a?void 0:a.name)&&void 0!==i?i:g.Nj})]}),(0,b.jsxs)(m.Tr,{children:[(0,b.jsx)(m.Td,{children:"Rows"}),(0,b.jsx)(m.Td,{children:null!==(t=null===o||void 0===o?void 0:o.row_count)&&void 0!==t?t:g.Nj}),(0,b.jsx)(m.Td,{children:null!==(l=null===a||void 0===a?void 0:a.row_count)&&void 0!==l?l:g.Nj})]}),(0,b.jsxs)(m.Tr,{children:[(0,b.jsx)(m.Td,{children:"Columns"}),(0,b.jsx)(m.Td,{children:null!==(s=null===o||void 0===o?void 0:o.col_count)&&void 0!==s?s:g.Nj}),(0,b.jsx)(m.Td,{children:null!==(d=null===a||void 0===a?void 0:a.col_count)&&void 0!==d?d:g.Nj})]}),(0,b.jsxs)(m.Tr,{children:[(0,b.jsx)(m.Td,{children:"Test status"}),(0,b.jsx)(m.Td,{children:(0,b.jsxs)(r.xv,{children:[(0,b.jsxs)(r.xv,{as:"span",fontWeight:700,children:[c.passed," "]}),"Passed",", ",(0,b.jsxs)(r.xv,{as:"span",fontWeight:700,color:c.failed>0?"red.500":"inherit",children:[c.failed," "]}),"Failed"]})}),(0,b.jsx)(m.Td,{children:(0,b.jsxs)(r.xv,{children:[(0,b.jsxs)(r.xv,{as:"span",fontWeight:700,children:[u.passed," "]}),"Passed",", ",(0,b.jsxs)(r.xv,{as:"span",fontWeight:700,color:u.failed>0?"red.500":"inherit",children:[u.failed," "]}),"Failed"]})})]})]})]})})}function q(e){var n,i=e.data,j=e.name,f=(0,c.useState)(null),p=(0,l.Z)(f,2),m=p[0],g=p[1],y=(0,s.qY)(),T=i.base,C=i.input;(0,_.h5)((0,_.C6)(!0).safeParse(i));var k=T.tables[j],S=C.tables[j],w=null===(n=T.tables[j])||void 0===n?void 0:n.dbt_assertion_result;(0,_.h5)(_.vT.safeParse(k)),(0,_.h5)(_.vT.safeParse(S));var P=(0,v.Ix)({data:i,reportName:j,type:"piperider"}),Z=(0,l.Z)(P,2),A=Z[0],O=Z[1],W=(0,v.Ix)({data:i,reportName:j,type:"dbt"}),E=(0,l.Z)(W,2),I=E[0],Y=E[1];return(0,h.j)(j),(0,b.jsxs)(u.o,{children:[(0,b.jsxs)(r.kC,{direction:"column",minH:"calc(100vh + 1px)",width:"100%",children:[(0,b.jsx)(r.kC,{mx:"10%",mt:4,children:(0,b.jsxs)(d.aG,{fontSize:"lg",children:[(0,b.jsx)(d.gN,{children:(0,b.jsx)(a.rU,{href:"/",children:(0,b.jsx)(d.At,{href:"/","data-cy":"cr-report-breadcrumb-back",children:"Tables"})})}),(0,b.jsx)(d.gN,{isCurrentPage:!0,children:(0,b.jsx)(d.At,{href:"#",children:j})})]})}),(0,b.jsxs)(r.kC,{border:"1px solid",borderColor:"gray.300",bg:"white",borderRadius:"md",p:6,mt:3,mx:"10%",direction:"column",gap:8,children:[(0,b.jsx)(r.X6,{fontSize:24,children:"Overview"}),(0,b.jsx)(Q,{baseTable:k,targetTable:S}),(0,b.jsxs)(o.mQ,{isLazy:!0,children:[(0,b.jsxs)(o.td,{children:[(0,b.jsx)(o.OK,{onClick:function(){(0,x._)({eventName:x.X.PAGE_VIEW,eventProperties:{type:"comparison-report",tab:"Schema"}})},children:"Schema"}),(0,b.jsx)(o.OK,{"data-cy":"cr-report-tab-item-profiling",onClick:function(){(0,x._)({eventName:x.X.PAGE_VIEW,eventProperties:{type:"comparison-report",tab:"Profiling"}})},children:"Profiling"}),(0,b.jsx)(o.OK,{"data-cy":"cr-report-tab-item-tests",onClick:function(){(0,x._)({eventName:x.X.PAGE_VIEW,eventProperties:{type:"comparison-report",tab:"Tests"}})},children:"Tests"}),w&&(0,b.jsx)(o.OK,{onClick:function(){(0,x._)({eventName:x.X.PAGE_VIEW,eventProperties:{type:"comparison-report",tab:"dbt Tests"}})},children:"dbt Tests"})]}),(0,b.jsxs)(o.nP,{children:[(0,b.jsx)(o.x4,{children:(0,b.jsx)(B,{base:k,target:S})}),(0,b.jsx)(o.x4,{children:(0,b.jsx)(G,{baseTable:k,targetTable:S})}),(0,b.jsx)(o.x4,{children:(0,b.jsx)($,{base:null===A||void 0===A?void 0:A.tests,target:null===O||void 0===O?void 0:O.tests,onDetailVisible:function(e){g({type:"piperider",data:e}),y.onOpen()}})}),(0,b.jsx)(o.x4,{children:0===(null===I||void 0===I?void 0:I.tests.length)&&0===(null===Y||void 0===Y?void 0:Y.tests.length)?(0,b.jsx)(r.kC,{justifyContent:"center",alignItems:"center",height:"100px",children:(0,b.jsx)(r.xv,{color:"gray.500",children:"No dbt tests available."})}):(0,b.jsx)($,{base:null===I||void 0===I?void 0:I.tests,target:null===Y||void 0===Y?void 0:Y.tests,onDetailVisible:function(e){g({type:"dbt",data:e}),y.onOpen()}})})]})]})]})]}),(0,b.jsx)(N,(0,t.Z)((0,t.Z)({},y),{},{type:null===m||void 0===m?void 0:m.type,data:null===m||void 0===m?void 0:m.data,onClose:function(){y.onClose(),g(null)}}))]})}},8453:function(e,n,i){i.d(n,{y:function(){return s}});var t=i(885),l=i(2791);function s(e){var n=(0,l.useState)(null),i=(0,t.Z)(n,2),s=i[0],r=i[1];return(0,l.useEffect)((function(){if(e&&e.current){var n=e.current,i=new ResizeObserver((function(e){e.forEach((function(e){r(e.contentRect)}))}));return i.observe(n),function(){i.unobserve(n)}}}),[e]),s}},3442:function(e,n,i){i.d(n,{X:function(){return l},_:function(){return s}});var t=i(8083),l={PAGE_VIEW:"Page View"};function s(e){var n=e.eventName,i=e.eventProperties,l=e.eventOptions;return window.PIPERIDER_METADATA.amplitude_api_key?(0,t.j)(n,i,l):console.info({eventName:n,eventProperties:i,eventOptions:l})}},9842:function(e,n,i){i.d(n,{p:function(){return h},v:function(){return v}});var t=i(9227),l=i(2387),s="var(--chakra-space-2)",r="var(--chakra-space-2)",d="var(--chakra-space-4)",o="var(--chakra-space-4)",a="var(--chakra-radii-md)",c="var(--chakra-colors-white)",u="var(--chakra-colors-blackAlpha-700)";function v(e){var n=e.target,i=e.style,l=void 0===i?{}:i;return t.Ys(n).append("div").attr("class","chart_tooltip").style("visibility","hidden").style("position","absolute").style("z-index","1501").style("padding-top",(null===l||void 0===l?void 0:l.paddingTop)||s).style("padding-bottom",(null===l||void 0===l?void 0:l.paddingBottom)||r).style("border-radius",(null===l||void 0===l?void 0:l.borderRadius)||a).style("padding-left",(null===l||void 0===l?void 0:l.paddingLeft)||d).style("padding-right",(null===l||void 0===l?void 0:l.paddingRight)||o).style("color",(null===l||void 0===l?void 0:l.color)||c).style("background-color",(null===l||void 0===l?void 0:l.backgroundColor)||u)}function h(e){var n=e.type;return e.isCategorical?l.bF:"string"===n?l.d4:"boolean"===n?l.RW:"datetime"===n?l.qI:l.E5}}}]);
//# sourceMappingURL=266.a1184f6e.chunk.js.map