"use strict";(self.webpackChunk_jupyterlab_nbgallery_autodownload=self.webpackChunk_jupyterlab_nbgallery_autodownload||[]).push([[568],{568:(e,o,n)=>{n.r(o),n.d(o,{default:()=>s});var t=n(345),a=n(398),c=n(569),r=n.n(c);const s={id:"@nbgallery/autodownload:autodownload",autoStart:!0,requires:[t.ISettingRegistry],activate:async(e,o)=>{let n="",t=0,c=!1;function s(){return a.PageConfig.getBaseUrl()}function l(e,o,n){r().ajax({method:"GET",headers:{Accept:"application/json"},url:e,cache:!1,xhrFields:{withCredentials:!0},success:function(e){!async function(e,o,n){r().ajax({url:s()+"post/"+e+"/"+encodeURIComponent(o)+".ipynb",type:"POST",success:function(){},error:function(e){console.error("Failed upload: "+o)},data:JSON.stringify({type:"notebook",content:JSON.parse(n)})})}(o,n,e)}})}function i(e,o,n){r().ajax({method:"GET",url:s()+"api/contents/"+encodeURIComponent(e),cache:!1,xhrFields:{withCredentials:!0},success:function(e){},error:function(t){console.info("Downloading notebooks to "+e),r().ajax({method:"POST",url:s()+"post/"+encodeURIComponent(e),data:JSON.stringify({type:"directory"}),cache:!1,success:function(t){r().ajax({method:"GET",headers:{Accept:"application/json"},url:o+n,cache:!1,xhrFields:{withCredentials:!0},success:function(n){let t;for(t in n){var a=n[t];l(o+"/notebooks/"+a.uuid+"/download?clickstream=false",e,a.title.replace(/\//g,"⁄"))}}})}})}})}Promise.all([e.restored,o.load("@jupyterlab-nbgallery/autodownload:autodownload")]).then((([,e])=>{try{!function(e){r().ajax({method:"GET",headers:{Accept:"application/json"},url:s()+"jupyterlab_nbgallery/environment",cache:!1,xhrFields:{withCredentials:!0},success:function(o){n=o.NBGALLERY_URL,t=o.NBGALLERY_ENABLE_AUTODOWNLOAD,c=e.get("enabled").composite,console.info("Auto Downloading Notebooks"),(1==t||c)&&(i("Starred",n,"/notebooks/stars"),i("Recently Executed",n,"/notebooks/recently_executed"))}})}(e)}catch(e){console.error(`Problem downloading notebooks \n ${e}`)}}))}}}}]);