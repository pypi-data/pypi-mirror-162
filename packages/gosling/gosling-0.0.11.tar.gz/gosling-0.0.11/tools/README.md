> Code adapted from https://github.com/altair-viz/altair/tree/master/tools
